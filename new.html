<!DOCTYPE html>
<html>
  <head>
    <title>India State User Count Map</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />

    <style>
      #map {
        height: 100vh;
        width: 100%;
        /* Ensure a dark background */
        background-color: #1a1a1a;
      }

      /* ðŸŒŸ HIDING THE EXTERNAL WORLD ðŸŒŸ */
      /* This rule changes the color of non-map areas (usually black) */
      .leaflet-container {
        background-color: #1a1a1a !important;
      }
      /* You might need to hide tiles outside India's bounds */
      /* This is complex and usually handled by bounding the view */
    </style>
  </head>
  <body>
    <div id="map"></div>

    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>

    <script>
      // === 1. DATA ===
      // Your actual user count data linked to state codes (replace with your full list)
      const userDataByState = {
        HR: 1000, // Haryana
        DL: 2000, // Delhi (can use NCT for National Capital Territory)
        MH: 15000, // Maharashtra
        KA: 8000, // Karnataka
        UP: 12000, // Uttar Pradesh
        RJ: 4000, // Rajasthan
        GJ: 6000, // Gujarat
        WB: 7500, // West Bengal
        MP: 5000, // Madhya Pradesh
        TN: 9000, // Tamil Nadu
      };

      // Simulated GeoJSON for demonstration (You MUST load the full India GeoJSON file)
      // A GeoJSON file contains polygons (state boundaries) with properties like state code.
      const indiaGeoJsonSimulated = {
        type: "FeatureCollection",
        features: [
          // Replace this array with the GeoJSON features for all states/UTs of India
          // Example: { "type": "Feature", "properties": { "ST_CODE": "DL", "ST_NAME": "Delhi" }, "geometry": { ... polygon data ... } }
        ],
      };

      // === 2. HELPER FUNCTIONS ===

      // Define color gradient based on user count (Choropleth styling)
      function getColor(d) {
        // These thresholds (2000, 5000, etc.) define the color scale. Adjust them based on your max/min user counts.
        return d > 12000
          ? "#800026" // Dark Red (Highest Count)
          : d > 9000
          ? "#BD0026"
          : d > 7000
          ? "#E31A1C"
          : d > 5000
          ? "#FC4E2A"
          : d > 3000
          ? "#FD8D3C"
          : d > 1000
          ? "#FEB24C"
          : "#FFEDA0"; // Light Yellow (Lowest Count)
      }

      // Apply style to each state polygon
      function style(feature) {
        const stateCode = feature.properties.ST_CODE; // Assumes your GeoJSON uses 'ST_CODE'
        const userCount = userDataByState[stateCode] || 0; // Get count, default to 0 if not found

        return {
          fillColor: getColor(userCount),
          weight: 2,
          opacity: 1,
          color: "white", // White border between states
          dashArray: "3",
          fillOpacity: 0.7,
        };
      }

      // === 3. MAP INITIALIZATION ===

      // Initialize the map centered on India with zoom level 4
      const map = L.map("map").setView([23.5, 78.5], 4);

      // Use a simple, dark base layer (CartoDB DarkMatter)
      L.tileLayer(
        "https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",
        {
          attribution: "&copy; CARTO",
          subdomains: "abcd",
          maxZoom: 19,
        }
      ).addTo(map);

      // === 4. HIDE THE EXTERNAL WORLD (Restricting Map Bounds) ===
      // This is the simplest way to visually cut off other continents.
      const indiaBounds = L.latLngBounds(L.latLng(6.5, 68), L.latLng(37, 98));
      map.setMaxBounds(indiaBounds);
      map.options.minZoom = 4; // Prevent zooming out past the country view

      // === 5. ADD GEOJSON LAYER (Choropleth) ===
      // IMPORTANT: In a real application, you would load the full GeoJSON file here
      // using L.geoJson. It must contain 'ST_CODE' or another property to match userDataByState.

      // For actual use, you need to fetch the GeoJSON file first:
      /*
        fetch('india_states.geojson')
            .then(response => response.json())
            .then(geojsonData => {
                L.geoJson(geojsonData, {
                    style: style,
                    // Optional: Add interaction like tooltips on hover
                    onEachFeature: function(feature, layer) {
                        const stateCode = feature.properties.ST_CODE;
                        const userCount = userDataByState[stateCode] || 0;
                        layer.bindPopup(feature.properties.ST_NAME + '<br>Users: ' + userCount.toLocaleString());
                    }
                }).addTo(map);
            });
        */

      // Since I cannot load an external GeoJSON, this step is placeholder.
      // Once you replace the simulated GeoJSON object and uncomment the fetch block above, this will work.
    </script>
  </body>
</html>
